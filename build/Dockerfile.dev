# Development Dockerfile with Air for hot reload
FROM golang:1.25-alpine

# Image labels (OCI standard)
LABEL org.opencontainers.image.title="tf-telemetry-dev"
LABEL org.opencontainers.image.description="Telemetry collection server - Development image with Air hot reload"
LABEL org.opencontainers.image.source="https://github.com/minhtt159/tf-telemetry"
LABEL org.opencontainers.image.vendor="hnimn.art"
LABEL org.opencontainers.image.authors="minhtt159 <4847344+minhtt159@users.noreply.github.com>"
LABEL org.opencontainers.image.licenses="MIT"

WORKDIR /app

# Install Air for hot reload
RUN go install github.com/air-verse/air@latest

# Copy go mod files
COPY go.mod go.sum ./
RUN go mod download

# Copy the entire project
COPY . .

# Create tmp directory for Air
RUN mkdir -p /app/tmp

# Expose ports
EXPOSE 50051 8080

# Run Air for hot reload (uses .air-docker.toml by default in compose.dev.yaml)
CMD ["air", "-c", ".air-docker.toml"]
